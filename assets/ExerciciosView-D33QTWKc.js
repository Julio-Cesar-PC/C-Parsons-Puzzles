import{d as k,e as b,r as u,f as I,c as B,g as e,w as L,v as j,n as M,h as T,t as A,p as H,o as D}from"./index-ByYOlQ5K.js";const{updateUserLevel:P}=b(),m=k.create({baseURL:"https://script.google.com/macros/s/AKfycbywGgvJFPnwXUqMjWtUkGqaewTqq7LaPNyMq2EmzEN-e-MoML1crdOTinf7upsxpEhl/exec"}),_=async r=>{try{let t;return console.log("auth getExercicio: ",r),r!=null?(t=await m.get("/exec?actionRequest=getExercicioAleatorio",{params:{dificuldade:"userDefault",userId:r.id}}),P(t.data.userLevelInfo)):t=await m.get("/exec?actionRequest=getExercicioAleatorio",{params:{dificuldade:"0"}}),t.data}catch(t){console.error(t)}},q={class:"flex items-start flex-wrap justify-center min-h-2xl px-20 my-2"},C={class:"fixed inset-0 flex justify-center items-center z-50"},R={class:"w-1/4"},F={class:"bg-code text-primary-content p-4 rounded"},S={__name:"ExerciciosView",setup(r){const t=u(""),a=u(!0);let i=null;const{userData:l,auth:n}=b(),c=async()=>{try{console.log("auth: ",n.value),a.value=!0,_(l.value).then(o=>{a.value=!1,console.log("getExercicioAleatorio: ",o),t.value=o.exercicio,i&&(document.getElementById("sortable").innerHTML="",document.getElementById("sortableTrash").innerHTML=""),i=new ParsonsWidget({sortableId:"sortable",trashId:"sortableTrash",max_wrong_lines:1,feedback_cb:g,lang:"ptbr"}),i.init(t.value.exercicio),i.shuffleLines()})}catch(o){console.error("Erro ao buscar exercício",o)}},v=async()=>{c()},x=()=>{i&&i.getFeedback().length===0&&(h("Parabéns! Você acertou o exercício!"),document.getElementById("btn-proximo-exercicio").removeAttribute("disabled"))},f=async()=>{if(a.value=!0,n.value){const o={actionRequest:"postHistorico",payload:{userId:l.value.id,startDate:new Date,submitDate:new Date,state:"completo",exerciseId:t.value.id,triesCount:"1",exerciseDifficulty:t.value.dificuldade},auth:n.value};await H(o)}d(),c()},d=()=>{E(),y(),p()},p=()=>{document.getElementById("btn-proximo-exercicio").setAttribute("disabled",!0)},g=o=>{d();let s=o.errors.map(w=>`${w}`).join("");document.getElementById("erros").innerHTML=`console > ${s}`},y=()=>{document.getElementById("erros").innerHTML=""},h=o=>{document.getElementById("feedback").innerHTML=o,document.getElementById("feedback").removeAttribute("hidden")},E=()=>{document.getElementById("feedback").innerHTML="",document.getElementById("feedback").setAttribute("hidden",!0)};return I(()=>{c()}),(o,s)=>(D(),B("main",null,[e("div",q,[L(e("div",C,s[0]||(s[0]=[e("span",{class:"loading loading-dots loading-lg"},null,-1)]),512),[[j,a.value]]),e("div",{class:M([{"blur-sm":a.value},"px-10 py-5 rounded-lg shadow-lg w-full mx-auto h-[90vh] bg-base-300 flex justify-center gap-8"])},[e("div",R,[e("div",null,[s[1]||(s[1]=e("h1",{class:"text-2xl font-bold mb-6 text-center"},"Enunciado:",-1)),e("div",F,A(t.value.enunciado),1),s[2]||(s[2]=e("div",{id:"feedback",class:"mt-4 p-4 bg-success rounded text-primary-content",hidden:""},null,-1)),s[3]||(s[3]=e("div",{class:"divider"},null,-1)),e("div",{class:"w-full flex justify-evenly items-center mt-4"},[e("div",{class:"join"},[e("button",{onClick:x,class:"btn btn-primary join-item"},"Enviar"),e("button",{onClick:v,class:"btn btn-secondary join-item"},"Resortear"),e("button",{onClick:f,id:"btn-proximo-exercicio",class:"btn btn-accent join-item",disabled:""},"Próximo")])])])]),s[4]||(s[4]=T('<div class="w-3/4"><div class="flex flex-wrap justify-evenly rounded mt-4 h-[70vh] max-h text-secondary-content"><div id="sortableTrash" class="py-4 px-2 sortable-code bg-code overflow-auto h-full max-h rounded"></div><div id="sortable" class="py-4 px-2 sortable-code bg-code overflow-auto h-full max-h rounded"></div></div><div class="divider"></div><div id="erros" class="mt-4 p-4 bg-info-content rounded"> console &gt; </div></div>',1))],2)])]))}};export{S as default};
