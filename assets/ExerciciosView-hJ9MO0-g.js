import{d as y,e as x,r as u,f as h,c as w,g as e,w as E,v as k,n as I,t as j,p as L,o as B}from"./index-D5v7rmjB.js";const{updateUserLevel:D}=x(),m=y.create({baseURL:"https://script.google.com/macros/s/AKfycbywGgvJFPnwXUqMjWtUkGqaewTqq7LaPNyMq2EmzEN-e-MoML1crdOTinf7upsxpEhl/exec"}),M=async i=>{try{let s;return console.log("auth getExercicio: ",i),i!=null?(s=await m.get("/exec?actionRequest=getExercicioAleatorio",{params:{dificuldade:"userDefault",userId:i.id}}),D(s.data.userLevelInfo)):s=await m.get("/exec?actionRequest=getExercicioAleatorio",{params:{dificuldade:"0"}}),s.data}catch(s){console.error(s)}},T={class:"flex items-start flex-wrap justify-center min-h-2xl px-20 my-2"},q={class:"fixed inset-0 flex justify-center items-center z-50"},A={class:"w-1/4"},H={class:"bg-code text-primary-content p-4 rounded"},_={__name:"ExerciciosView",setup(i){const s=u(""),r=u(!0);let a=null;const{userData:l,auth:c}=x(),n=async()=>{try{console.log("auth: ",c.value),r.value=!0,M(l.value).then(t=>{r.value=!1,console.log("getExercicioAleatorio: ",t),s.value=t.exercicio,a&&(document.getElementById("sortable").innerHTML="",document.getElementById("sortableTrash").innerHTML=""),a=new ParsonsWidget({sortableId:"sortable",trashId:"sortableTrash",max_wrong_lines:1,feedback_cb:d,lang:"ptbr"}),a.init(s.value.exercicio),a.shuffleLines()})}catch(t){console.error("Erro ao buscar exercício",t)}},b=async()=>{n()},f=()=>{if(a){let t=a.getFeedback();t.length===0?(v("Parabéns! Você acertou o exercício!"),document.getElementById("btn-proximo-exercicio").removeAttribute("disabled")):d(t)}},p=async()=>{r.value=!0;const t={actionRequest:"postHistorico",payload:{userId:l.value.id,startDate:new Date,submitDate:new Date,state:"completo",exerciseId:s.value.id,triesCount:"1",exerciseDifficulty:s.value.dificuldade},auth:c.value};await L(t),n()},d=t=>{let o=t.errors.map(g=>`<p>${g}</p>`).join("");document.getElementById("erros").innerHTML=`<h2>Erros:</h2> ${o}`},v=t=>{document.getElementById("feedback").innerHTML=t,document.getElementById("feedback").removeAttribute("hidden")};return h(()=>{n()}),(t,o)=>(B(),w("main",null,[e("div",T,[E(e("div",q,o[0]||(o[0]=[e("span",{class:"loading loading-dots loading-lg"},null,-1)]),512),[[k,r.value]]),e("div",{class:I([{"blur-sm":r.value},"px-10 py-5 rounded-lg shadow-lg w-full mx-auto h-[90vh] bg-base-300 flex justify-center gap-8"])},[e("div",A,[e("div",null,[o[1]||(o[1]=e("h1",{class:"text-2xl font-bold mb-6 text-center"},"Enunciado:",-1)),e("div",H,j(s.value.enunciado),1),o[2]||(o[2]=e("div",{class:"divider"},null,-1)),o[3]||(o[3]=e("div",{id:"erros",class:"mt-4 p-4 bg-info-content rounded"},null,-1)),o[4]||(o[4]=e("div",{id:"feedback",class:"mt-4 p-4 bg-success rounded text-primary-content",hidden:""},null,-1))])]),e("div",{class:"w-3/4"},[e("div",{class:"w-full flex justify-evenly items-center"},[e("div",{class:"join"},[e("button",{onClick:f,class:"btn btn-primary join-item"},"Enviar"),e("button",{onClick:b,class:"btn btn-secondary join-item"},"Resortear"),e("button",{onClick:p,id:"btn-proximo-exercicio",class:"btn btn-accent join-item",disabled:""},"Próximo")])]),o[5]||(o[5]=e("div",{class:"flex flex-wrap justify-evenly rounded mt-4 h-[70vh] max-h text-secondary-content"},[e("div",{id:"sortableTrash",class:"py-4 px-2 sortable-code bg-code overflow-auto h-full max-h rounded"}),e("div",{id:"sortable",class:"py-4 px-2 sortable-code bg-code overflow-auto h-full max-h rounded"})],-1))])],2)])]))}};export{_ as default};
