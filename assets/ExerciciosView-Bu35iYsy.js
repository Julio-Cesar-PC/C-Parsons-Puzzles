import{c as i,d,o as r,e,f as v,t as y,r as m,g as I,w as M,v as j,n as H,h as L,i as V,j as N,p as P}from"./index-CYUS4wUs.js";import{g as D}from"./exercicios-DWaJOcgV.js";const O={key:0,role:"alert",class:"alert alert-warning flex items-center gap-2"},$={__name:"AlertaVidas",props:{vidas:{type:Number,required:!0}},setup(c){return(t,l)=>c.vidas!==void 0?(r(),i("div",O,[l[2]||(l[2]=e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6 shrink-0 stroke-current",fill:"none",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})],-1)),e("span",null,[l[0]||(l[0]=v("Cuidado! Você tem ")),e("strong",null,y(c.vidas),1),l[1]||(l[1]=v(" vidas sobrando."))])])):d("",!0)}},F={class:"flex items-start flex-wrap justify-center min-h-2xl px-20 my-2"},S={class:"fixed inset-0 flex flex-col justify-center items-center z-50"},q={class:"w-1/4"},z={class:"bg-code text-primary-content p-4 rounded"},A={id:"modal-success",class:"modal"},R={class:"modal-box w-full max-w-7xl"},W={class:"flex gap-4"},G={role:"tablist",class:"tabs tabs-bordered pb-5 px-0 w-full"},J={key:0,type:"radio",name:"tabs-2",role:"tab",class:"tab","aria-label":"Python Tutor",checked:""},K={key:1,role:"tabpanel",class:"tab-content p-5 border rounded h-[55vh] w-full"},Q=["src"],U={key:2,type:"radio",name:"tabs-2",role:"tab",class:"tab","aria-label":"OneCompiler"},X={key:3,role:"tabpanel",class:"tab-content p-5 border rounded h-[55vh] w-full"},Y=["src"],Z={id:"modal-feedback",class:"modal"},ee={class:"modal-box max-w-5xl"},se={__name:"ExerciciosView",setup(c){const t=m(""),l=m(!0);let a=null;const{userData:b,auth:p}=N(),n=m(1),u=async()=>{try{T(),l.value=!0,D(b.value).then(s=>{l.value=!1,s.exercicio?t.value=s.exercicio:(console.error("Nenhum exercício encontrado"),a&&(document.getElementById("sortable").innerHTML="",document.getElementById("sortableTrash").innerHTML="",a=null,t.value=""),document.getElementById("modal-error").showModal()),a&&(document.getElementById("sortable").innerHTML="",document.getElementById("sortableTrash").innerHTML=""),t.value&&(a=new ParsonsWidget({sortableId:"sortable",trashId:"sortableTrash",max_wrong_lines:1,feedback_cb:_,lang:"ptbr"}),a.init(t.value.exercicio),a.shuffleLines())})}catch(s){console.error("Erro ao buscar exercício",s)}},f=async()=>{console.log("Resorteando parsons..."),u()},w=()=>{console.log("Enviando código..."),console.log("triesCount: ",n.value),a&&(a.getFeedback().length===0?document.getElementById("modal-success").showModal():t.value.max_tries>0&&n.value>t.value.max_tries?(console.log("Você excedeu o número máximo de tentativas."),f()):document.getElementById("modal-feedback").showModal())},E=async()=>{if(l.value=!0,p.value){const s={actionRequest:"postHistorico",payload:{userId:b.value.id,startDate:new Date,submitDate:new Date,state:"completo",exerciseId:t.value.id,triesCount:n.value,exerciseDifficulty:t.value.dificuldade},auth:p.value};await P(s)}x(),u()},x=()=>{C(),document.getElementById("modal-success").close()},k=()=>{n.value+=1},T=()=>{n.value=1},_=s=>{x();let o=s.errors.map(B=>`"log_error" ${B}`).join("<br>");s.errors.length>0&&k();const g=document.getElementById("erros"),h=document.getElementById("erros-modal");g&&(g.innerHTML=`console > ${o}`),h&&(h.innerHTML=`console > ${o}`)},C=()=>{const s=document.getElementById("erros"),o=document.getElementById("erros-modal");s&&(s.innerHTML="console >"),o&&(o.innerHTML="console >")};return I(()=>{u()}),(s,o)=>(r(),i("main",null,[e("div",F,[M(e("div",S,o[0]||(o[0]=[e("div",{class:"bg-base-100 px-8 py-6 rounded-lg shadow-lg text-center bg-opacity-50 flex flex-col items-center"},[e("p",{class:"text-lg font-mono"},"Carregando novo desafio..."),e("div",{class:"loader mt-10"})],-1)]),512),[[j,l.value]]),e("div",{class:H([{"blur-sm":l.value},"px-10 py-5 rounded-lg shadow-lg w-full mx-auto h-[88vh] bg-base-300 flex justify-center gap-8 overflow-auto"])},[e("div",q,[e("div",null,[e("div",{class:"w-full flex justify-evenly items-center my-4"},[e("div",{class:"join"},[e("button",{onClick:f,class:"btn btn-secondary join-item"}," Resortear "),e("button",{onClick:w,class:"btn btn-primary join-item"},"Enviar")])]),o[1]||(o[1]=e("div",{class:"divider"},null,-1)),o[2]||(o[2]=e("h1",{class:"text-2xl font-bold mb-4 text-center"},"Enunciado:",-1)),e("div",z,y(t.value.enunciado),1)])]),o[3]||(o[3]=L('<div class="w-3/4"><div class="flex flex-wrap justify-evenly rounded mt-4 h-[70vh] max-h text-secondary-content"><div id="sortableTrash" class="py-4 px-2 sortable-code bg-code overflow-auto h-full max-h rounded"></div><div id="sortable" class="py-4 px-2 sortable-code bg-code overflow-auto h-full max-h rounded"></div></div><div class="divider"></div><div id="erros" class="mt-4 p-4 bg-info-content rounded">console &gt;</div></div>',1))],2)]),o[12]||(o[12]=e("dialog",{id:"modal-error",class:"modal"},[e("div",{class:"modal-box"},[e("h3",{class:"text-lg font-bold"},"Por enqunto não temos mais exercícios para você!"),e("p",{class:"mt-4 p-4"},[e("br"),v(" Você pode tentar novamente mais tarde, ou entrar em contato com o suporte. ")]),e("div",{class:"collapse bg-base-200"},[e("input",{type:"checkbox"}),e("div",{class:"collapse-title text-xl font-medium"},"Mostrar motivos"),e("div",{class:"collapse-content"},[e("ul",{class:"list-disc list-inside"},[e("li",null,"Não existe exercícios para seu nível"),e("li",null,"Erro de conexão"),e("li",null,"Erro no servidor"),e("li",null,"Erro no banco de dados")])])]),e("div",{class:"modal-action"},[e("form",{method:"dialog"},[e("button",{class:"btn mr-2"},"Fechar")])])])],-1)),e("dialog",A,[e("div",R,[o[5]||(o[5]=e("h3",{class:"text-lg font-bold"},"Parabéns! Você acertou o exercício!",-1)),e("div",W,[e("div",G,[t.value.pythonTutor?(r(),i("input",J)):d("",!0),t.value.pythonTutor?(r(),i("div",K,[e("iframe",{src:t.value.pythonTutor,class:"w-full h-full rounded-lg",title:"Python Tutor"},null,8,Q)])):d("",!0),t.value.linkOneCompiler?(r(),i("input",U)):d("",!0),t.value.linkOneCompiler?(r(),i("div",X,[e("iframe",{src:`https://onecompiler.com/embed/c/${t.value.linkOneCompiler}?theme=dark&hideLanguageSelection=true&hideNew=true&hideNewFileOption=true`,class:"w-full h-full rounded-lg",title:"OneCompiler"},null,8,Y)])):d("",!0)])]),e("div",{class:"modal-action mt-6"},[e("form",{method:"dialog"},[o[4]||(o[4]=e("button",{class:"btn mr-2"},"Fechar",-1)),e("button",{class:"btn btn-primary",onClick:E},"Próximo Exercício")])])])]),e("dialog",Z,[e("div",ee,[o[6]||(o[6]=e("form",{method:"dialog"},[e("button",{class:"btn btn-sm btn-circle btn-ghost absolute right-2 top-2"},"✕")],-1)),o[7]||(o[7]=e("h3",{class:"text-lg font-bold"},"Feedback do Exercício",-1)),o[8]||(o[8]=e("p",{class:"mt-4"},"Verifique os erros e acertos do seu exercício.",-1)),t.value.max_tries>0?(r(),V($,{key:0,class:"mt-4",vidas:t.value.max_tries-n.value+1},null,8,["vidas"])):d("",!0),o[9]||(o[9]=e("div",{class:"divider"},null,-1)),o[10]||(o[10]=e("div",{id:"erros-modal",class:"mt-4 p-4 bg-info-content rounded"},"console >",-1)),o[11]||(o[11]=e("p",{class:"text-sm mt-2 text-right italic text-code"}," O feedback te ajuda a enteder os erros da sua solução. ",-1))])])]))}};export{se as default};
