import{r as u,d as T,c as r,e,w as C,v as I,n as B,f as M,t as j,g as H,h as n,i as P,p as D,o as i}from"./index-BCYclfX7.js";import{g as L}from"./exercicios-CzPdZsQm.js";const V={class:"flex items-start flex-wrap justify-center min-h-2xl px-20 my-2"},N={class:"fixed inset-0 flex flex-col justify-center items-center z-50"},O={class:"w-1/4"},F={class:"bg-code text-primary-content p-4 rounded"},S={id:"modal-success",class:"modal"},$={class:"modal-box w-full max-w-7xl"},q={class:"flex gap-4"},z={role:"tablist",class:"tabs tabs-lifted pb-5 px-0 w-full"},A={key:0,type:"radio",name:"tabs-2",role:"tab",class:"tab","aria-label":"Python Tutor",checked:""},R={key:1,role:"tabpanel",class:"tab-content p-5 bg-base-100 border rounded h-[55vh] w-full"},W=["src"],G={key:2,type:"radio",name:"tabs-2",role:"tab",class:"tab","aria-label":"OneCompiler"},J={key:3,role:"tabpanel",class:"tab-content p-5 bg-base-100 border rounded h-[55vh] w-full"},K=["src"],Y={__name:"ExerciciosView",setup(Q){const s=u(""),a=u(!0);let l=null;const{userData:m,auth:b}=P(),d=u(1),c=async()=>{try{w(),a.value=!0,L(m.value).then(t=>{a.value=!1,t.exercicio?s.value=t.exercicio:document.getElementById("modal-error").showModal(),l&&(document.getElementById("sortable").innerHTML="",document.getElementById("sortableTrash").innerHTML=""),s.value&&(l=new ParsonsWidget({sortableId:"sortable",trashId:"sortableTrash",max_wrong_lines:1,feedback_cb:E,lang:"ptbr"}),l.init(s.value.exercicio),l.shuffleLines())})}catch(t){console.error("Erro ao buscar exercício",t)}},x=async()=>{c()},g=()=>{l&&(l.getFeedback().length===0?document.getElementById("modal-success").showModal():document.getElementById("modal-feedback").showModal())},h=async()=>{if(a.value=!0,b.value){const t={actionRequest:"postHistorico",payload:{userId:m.value.id,startDate:new Date,submitDate:new Date,state:"completo",exerciseId:s.value.id,triesCount:d.value,exerciseDifficulty:s.value.dificuldade},auth:b.value};await D(t)}v(),c()},v=()=>{_(),document.getElementById("modal-success").close()},y=()=>{d.value+=1},w=()=>{d.value=1},E=t=>{v();let o=t.errors.map(k=>`"log_error" ${k}`).join("<br>");t.errors.length>0&&y();const f=document.getElementById("erros"),p=document.getElementById("erros-modal");f&&(f.innerHTML=`console > ${o}`),p&&(p.innerHTML=`console > ${o}`)},_=()=>{const t=document.getElementById("erros"),o=document.getElementById("erros-modal");t&&(t.innerHTML="console >"),o&&(o.innerHTML="console >")};return T(()=>{c()}),(t,o)=>(i(),r("main",null,[e("div",V,[C(e("div",N,o[0]||(o[0]=[e("div",{class:"bg-base-100 px-8 py-6 rounded-lg shadow-lg text-center bg-opacity-50 flex flex-col items-center"},[e("p",{class:"text-lg font-mono"},"Carregando novo desafio..."),e("div",{class:"loader mt-10"})],-1)]),512),[[I,a.value]]),e("div",{class:B([{"blur-sm":a.value},"px-10 py-5 rounded-lg shadow-lg w-full mx-auto h-[88vh] bg-base-300 flex justify-center gap-8 overflow-auto"])},[e("div",O,[e("div",null,[e("div",{class:"w-full flex justify-evenly items-center my-4"},[e("div",{class:"join"},[e("button",{onClick:x,class:"btn btn-secondary join-item"}," Resortear "),e("button",{onClick:g,class:"btn btn-primary join-item"},"Enviar")])]),o[1]||(o[1]=e("div",{class:"divider"},null,-1)),o[2]||(o[2]=e("h1",{class:"text-2xl font-bold mb-4 text-center"},"Enunciado:",-1)),e("div",F,j(s.value.enunciado),1)])]),o[3]||(o[3]=M('<div class="w-3/4"><div class="flex flex-wrap justify-evenly rounded mt-4 h-[70vh] max-h text-secondary-content"><div id="sortableTrash" class="py-4 px-2 sortable-code bg-code overflow-auto h-full max-h rounded"></div><div id="sortable" class="py-4 px-2 sortable-code bg-code overflow-auto h-full max-h rounded"></div></div><div class="divider"></div><div id="erros" class="mt-4 p-4 bg-info-content rounded">console &gt;</div></div>',1))],2)]),o[6]||(o[6]=e("dialog",{id:"modal-error",class:"modal"},[e("div",{class:"modal-box"},[e("h3",{class:"text-lg font-bold"},"Por enqunto não temos mais exercícios para você!"),e("p",{class:"mt-4 p-4"},[e("br"),H(" Você pode tentar novamente mais tarde, ou entrar em contato com o suporte. ")]),e("div",{class:"collapse bg-base-200"},[e("input",{type:"checkbox"}),e("div",{class:"collapse-title text-xl font-medium"},"Mostrar motivos"),e("div",{class:"collapse-content"},[e("ul",{class:"list-disc list-inside"},[e("li",null,"Não existe exercícios para seu nível"),e("li",null,"Erro de conexão"),e("li",null,"Erro no servidor"),e("li",null,"Erro no banco de dados")])])]),e("div",{class:"modal-action"},[e("form",{method:"dialog"},[e("button",{class:"btn mr-2"},"Fechar")])])])],-1)),e("dialog",S,[e("div",$,[o[5]||(o[5]=e("h3",{class:"text-lg font-bold"},"Parabéns! Você acertou o exercício!",-1)),e("div",q,[e("div",z,[s.value.pythonTutor?(i(),r("input",A)):n("",!0),s.value.pythonTutor?(i(),r("div",R,[e("iframe",{src:s.value.pythonTutor,class:"w-full h-full rounded-lg",title:"Python Tutor"},null,8,W)])):n("",!0),s.value.linkOneCompiler?(i(),r("input",G)):n("",!0),s.value.linkOneCompiler?(i(),r("div",J,[e("iframe",{src:`https://onecompiler.com/embed/c/${s.value.linkOneCompiler}?theme=dark&hideLanguageSelection=true&hideNew=true&hideNewFileOption=true`,class:"w-full h-full rounded-lg",title:"OneCompiler"},null,8,K)])):n("",!0)])]),e("div",{class:"modal-action mt-6"},[e("form",{method:"dialog"},[o[4]||(o[4]=e("button",{class:"btn mr-2"},"Fechar",-1)),e("button",{class:"btn btn-primary",onClick:h},"Próximo Exercício")])])])]),o[7]||(o[7]=e("dialog",{id:"modal-feedback",class:"modal"},[e("div",{class:"modal-box max-w-5xl"},[e("form",{method:"dialog"},[e("button",{class:"btn btn-sm btn-circle btn-ghost absolute right-2 top-2"},"✕")]),e("h3",{class:"text-lg font-bold"},"Feedback do Exercício"),e("p",{class:"mt-4"},"Verifique os erros e acertos do seu exercício."),e("div",{class:"divider"}),e("div",{id:"erros-modal",class:"mt-4 p-4 bg-info-content rounded"},"console >"),e("p",{class:"text-sm mt-2 text-right italic text-code"}," O feedback te ajuda a enteder os erros da sua solução. ")])],-1))]))}};export{Y as default};
