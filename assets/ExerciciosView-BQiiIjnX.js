import{d as C,e as x,r as c,f as I,c as T,g as e,w as j,v as L,n as M,h as k,t as B,p as D,o as q}from"./index-CcVOQS2E.js";const{updateUserLevel:H}=x(),v=C.create({baseURL:"https://script.google.com/macros/s/AKfycbywGgvJFPnwXUqMjWtUkGqaewTqq7LaPNyMq2EmzEN-e-MoML1crdOTinf7upsxpEhl/exec"}),P=async l=>{try{let o;return console.log("auth getExercicio: ",l),l!=null?(o=await v.get("/exec?actionRequest=getExercicioAleatorio",{params:{dificuldade:"userDefault",userId:l.id}}),H(o.data.userLevelInfo)):o=await v.get("/exec?actionRequest=getExercicioAleatorio",{params:{dificuldade:"0"}}),o.data}catch(o){console.error(o)}},_={class:"flex items-start flex-wrap justify-center min-h-2xl px-20 my-2"},A={class:"fixed inset-0 flex flex-col justify-center items-center z-50"},R={class:"w-1/4"},N={class:"bg-code text-primary-content p-4 rounded"},U={__name:"ExerciciosView",setup(l){const o=c(""),r=c(!0);let a=null;const{userData:d,auth:u}=x(),i=c(1),n=async()=>{try{y(),r.value=!0,P(d.value).then(s=>{r.value=!1,o.value=s.exercicio,a&&(document.getElementById("sortable").innerHTML="",document.getElementById("sortableTrash").innerHTML=""),a=new ParsonsWidget({sortableId:"sortable",trashId:"sortableTrash",max_wrong_lines:1,feedback_cb:h,lang:"ptbr"}),a.init(o.value.exercicio),a.shuffleLines()})}catch(s){console.error("Erro ao buscar exercício",s)}},f=async()=>{n()},p=()=>{a&&a.getFeedback().length===0&&document.getElementById("modal-success").showModal()},g=async()=>{if(r.value=!0,console.log("triesCount: ",i.value),u.value){const s={actionRequest:"postHistorico",payload:{userId:d.value.id,startDate:new Date,submitDate:new Date,state:"completo",exerciseId:o.value.id,triesCount:i.value,exerciseDifficulty:o.value.dificuldade},auth:u.value};await D(s)}m(),n()},m=()=>{w(),document.getElementById("modal-success").close()},b=()=>{i.value+=1,console.log("triesCount: ",i.value)},y=()=>{i.value=1},h=s=>{m();let t=s.errors.map(E=>`${E}`).join("");s.errors.length>0&&b(),document.getElementById("erros").innerHTML=`console > ${t}`},w=()=>{document.getElementById("erros").innerHTML=""};return I(()=>{n()}),(s,t)=>(q(),T("main",null,[e("div",_,[j(e("div",A,t[0]||(t[0]=[e("div",{class:"bg-base-100 px-8 py-6 rounded-lg shadow-lg text-center bg-opacity-50 flex flex-col items-center"},[e("p",{class:"text-lg font-mono"},"Carregando novo desafio..."),e("div",{class:"loader mt-10"})],-1)]),512),[[L,r.value]]),e("div",{class:M([{"blur-sm":r.value},"px-10 py-5 rounded-lg shadow-lg w-full mx-auto h-[88vh] bg-base-300 flex justify-center gap-8"])},[e("div",R,[e("div",null,[e("div",{class:"w-full flex justify-evenly items-center my-4"},[e("div",{class:"join"},[e("button",{onClick:f,class:"btn btn-secondary join-item"},"Resortear"),e("button",{onClick:p,class:"btn btn-primary join-item"},"Enviar")])]),t[1]||(t[1]=e("div",{class:"divider"},null,-1)),t[2]||(t[2]=e("h1",{class:"text-2xl font-bold mb-4 text-center"},"Enunciado:",-1)),e("div",N,B(o.value.enunciado),1)])]),t[3]||(t[3]=k('<div class="w-3/4"><div class="flex flex-wrap justify-evenly rounded mt-4 h-[70vh] max-h text-secondary-content"><div id="sortableTrash" class="py-4 px-2 sortable-code bg-code overflow-auto h-full max-h rounded"></div><div id="sortable" class="py-4 px-2 sortable-code bg-code overflow-auto h-full max-h rounded"></div></div><div class="divider"></div><div id="erros" class="mt-4 p-4 bg-info-content rounded"> console &gt; </div></div>',1))],2)]),e("dialog",{id:"modal-success",class:"modal"},[e("div",{class:"modal-box"},[t[5]||(t[5]=e("h3",{class:"text-lg font-bold"},"Parabéns! Você acertou o exercício!",-1)),e("div",{class:"modal-action"},[e("form",{method:"dialog"},[t[4]||(t[4]=e("button",{class:"btn mr-2"},"Continuar",-1)),e("button",{onClick:g,id:"btn-proximo-exercicio",class:"btn btn-primary"},"Avançar")])])])])]))}};export{U as default};
